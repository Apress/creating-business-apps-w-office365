/*
 * SPServices - Work with SharePoint's Web Services using jQuery
 * Version 2014.02
 * @requires jQuery v1.8 or greater - jQuery 1.10.x+ recommended
 *
 * Copyright (c) 2009-2014 Sympraxis Consulting LLC
 * Examples and docs at:
 * http://spservices.codeplex.com
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
/*
 * @description Work with SharePoint's Web Services using jQuery
 * @type jQuery
 * @name SPServices
 * @category Plugins/SPServices
 * @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
 */
(function(ao){var ab="2014.02";var Q="/";var ah=";#";var al="Column not found on page";var ad="http://schemas.microsoft.com/sharepoint";var at="MultiLookupPicker";var g="MultiLookup";var Y={simple:"S",complex:"C",multiSelect:"M"};var ar=["Integer","Text","Note","DateTime","Counter","Choice","Lookup","Boolean","Number","Currency","URL","MultiChoice","Calculated","File","Attachments","User","ModStat","ContentTypeId","WorkflowStatus","UserMulti","LookupMulti","datetime","float","Calc"];var B={};var b="Alerts";var v="Authentication";var aq="Copy";var G="Forms";var ay="Lists";var m="Meetings";var af="OfficialFile";var C="People";var f="Permissions";var h="PublishedLinksService";var am="Search";var ak="SharePointDiagnostics";var aa="SiteData";var aG="Sites";var J="SocialDataService";var ai="SpellCheck";var o="TaxonomyClientService";var l="usergroup";var K="UserProfileService";var E="Versions";var aF="Views";var e="WebPartPages";var aC="Webs";var F="Workflow";var ae=new av();var O=0;var y=["listName","description"];var U=[];U.GetAlerts=[b,false];U.DeleteAlerts=[b,true];U.Mode=[v,false];U.Login=[v,false];U.CopyIntoItems=[aq,true];U.CopyIntoItemsLocal=[aq,true];U.GetItem=[aq,false];U.GetForm=[G,false];U.GetFormCollection=[G,false];U.AddAttachment=[ay,true];U.AddDiscussionBoardItem=[ay,true];U.AddList=[ay,true];U.AddListFromFeature=[ay,true];U.ApplyContentTypeToList=[ay,true];U.CheckInFile=[ay,true];U.CheckOutFile=[ay,true];U.CreateContentType=[ay,true];U.DeleteAttachment=[ay,true];U.DeleteContentType=[ay,true];U.DeleteContentTypeXmlDocument=[ay,true];U.DeleteList=[ay,true];U.GetAttachmentCollection=[ay,false];U.GetList=[ay,false];U.GetListAndView=[ay,false];U.GetListCollection=[ay,false];U.GetListContentType=[ay,false];U.GetListContentTypes=[ay,false];U.GetListItemChanges=[ay,false];U.GetListItemChangesSinceToken=[ay,false];U.GetListItems=[ay,false];U.GetVersionCollection=[ay,false];U.UndoCheckOut=[ay,true];U.UpdateContentType=[ay,true];U.UpdateContentTypesXmlDocument=[ay,true];U.UpdateContentTypeXmlDocument=[ay,true];U.UpdateList=[ay,true];U.UpdateListItems=[ay,true];U.AddMeeting=[m,true];U.CreateWorkspace=[m,true];U.RemoveMeeting=[m,true];U.SetWorkSpaceTitle=[m,true];U.GetRecordRouting=[af,false];U.GetRecordRoutingCollection=[af,false];U.GetServerInfo=[af,false];U.SubmitFile=[af,true];U.ResolvePrincipals=[C,true];U.SearchPrincipals=[C,false];U.AddPermission=[f,true];U.AddPermissionCollection=[f,true];U.GetPermissionCollection=[f,true];U.RemovePermission=[f,true];U.RemovePermissionCollection=[f,true];U.UpdatePermission=[f,true];U.GetLinks=[h,true];U.GetPortalSearchInfo=[am,false];U.GetQuerySuggestions=[am,false];U.GetSearchMetadata=[am,false];U.Query=[am,false];U.QueryEx=[am,false];U.Registration=[am,false];U.Status=[am,false];U.SendClientScriptErrorReport=[ak,true];U.GetAttachments=[aa,false];U.EnumerateFolder=[aa,false];U.SiteDataGetList=[aa,false];U.SiteDataGetListCollection=[aa,false];U.SiteDataGetSite=[aa,false];U.SiteDataGetSiteUrl=[aa,false];U.SiteDataGetWeb=[aa,false];U.CreateWeb=[aG,true];U.DeleteWeb=[aG,true];U.GetSite=[aG,false];U.GetSiteTemplates=[aG,false];U.AddComment=[J,true];U.AddTag=[J,true];U.AddTagByKeyword=[J,true];U.CountCommentsOfUser=[J,false];U.CountCommentsOfUserOnUrl=[J,false];U.CountCommentsOnUrl=[J,false];U.CountRatingsOnUrl=[J,false];U.CountTagsOfUser=[J,false];U.DeleteComment=[J,true];U.DeleteRating=[J,true];U.DeleteTag=[J,true];U.DeleteTagByKeyword=[J,true];U.DeleteTags=[J,true];U.GetAllTagTerms=[J,false];U.GetAllTagTermsForUrlFolder=[J,false];U.GetAllTagUrls=[J,false];U.GetAllTagUrlsByKeyword=[J,false];U.GetCommentsOfUser=[J,false];U.GetCommentsOfUserOnUrl=[J,false];U.GetCommentsOnUrl=[J,false];U.GetRatingAverageOnUrl=[J,false];U.GetRatingOfUserOnUrl=[J,false];U.GetRatingOnUrl=[J,false];U.GetRatingsOfUser=[J,false];U.GetRatingsOnUrl=[J,false];U.GetSocialDataForFullReplication=[J,false];U.GetTags=[J,true];U.GetTagsOfUser=[J,true];U.GetTagTerms=[J,true];U.GetTagTermsOfUser=[J,true];U.GetTagTermsOnUrl=[J,true];U.GetTagUrlsOfUser=[J,true];U.GetTagUrlsOfUserByKeyword=[J,true];U.GetTagUrls=[J,true];U.GetTagUrlsByKeyword=[J,true];U.SetRating=[J,true];U.UpdateComment=[J,true];U.SpellCheck=[ai,false];U.AddTerms=[o,true];U.GetChildTermsInTerm=[o,false];U.GetChildTermsInTermSet=[o,false];U.GetKeywordTermsByGuids=[o,false];U.GetTermsByLabel=[o,false];U.GetTermSets=[o,false];U.AddGroup=[l,true];U.AddGroupToRole=[l,true];U.AddRole=[l,true];U.AddRoleDef=[l,true];U.AddUserCollectionToGroup=[l,true];U.AddUserCollectionToRole=[l,true];U.AddUserToGroup=[l,true];U.AddUserToRole=[l,true];U.GetAllUserCollectionFromWeb=[l,false];U.GetGroupCollection=[l,false];U.GetGroupCollectionFromRole=[l,false];U.GetGroupCollectionFromSite=[l,false];U.GetGroupCollectionFromUser=[l,false];U.GetGroupCollectionFromWeb=[l,false];U.GetGroupInfo=[l,false];U.GetRoleCollection=[l,false];U.GetRoleCollectionFromGroup=[l,false];U.GetRoleCollectionFromUser=[l,false];U.GetRoleCollectionFromWeb=[l,false];U.GetRoleInfo=[l,false];U.GetRolesAndPermissionsForCurrentUser=[l,false];U.GetRolesAndPermissionsForSite=[l,false];U.GetUserCollection=[l,false];U.GetUserCollectionFromGroup=[l,false];U.GetUserCollectionFromRole=[l,false];U.GetUserCollectionFromSite=[l,false];U.GetUserCollectionFromWeb=[l,false];U.GetUserInfo=[l,false];U.GetUserLoginFromEmail=[l,false];U.RemoveGroup=[l,true];U.RemoveGroupFromRole=[l,true];U.RemoveRole=[l,true];U.RemoveUserCollectionFromGroup=[l,true];U.RemoveUserCollectionFromRole=[l,true];U.RemoveUserCollectionFromSite=[l,true];U.RemoveUserFromGroup=[l,true];U.RemoveUserFromRole=[l,true];U.RemoveUserFromSite=[l,true];U.RemoveUserFromWeb=[l,true];U.UpdateGroupInfo=[l,true];U.UpdateRoleDefInfo=[l,true];U.UpdateRoleInfo=[l,true];U.UpdateUserInfo=[l,true];U.AddColleague=[K,true];U.AddLink=[K,true];U.AddMembership=[K,true];U.AddPinnedLink=[K,true];U.CreateMemberGroup=[K,true];U.CreateUserProfileByAccountName=[K,true];U.GetCommonColleagues=[K,false];U.GetCommonManager=[K,false];U.GetCommonMemberships=[K,false];U.GetInCommon=[K,false];U.GetPropertyChoiceList=[K,false];U.GetUserColleagues=[K,false];U.GetUserLinks=[K,false];U.GetUserMemberships=[K,false];U.GetUserPinnedLinks=[K,false];U.GetUserProfileByGuid=[K,false];U.GetUserProfileByIndex=[K,false];U.GetUserProfileByName=[K,false];U.GetUserProfileCount=[K,false];U.GetUserProfileSchema=[K,false];U.GetUserPropertyByAccountName=[K,false];U.ModifyUserPropertyByAccountName=[K,true];U.RemoveAllColleagues=[K,true];U.RemoveAllLinks=[K,true];U.RemoveAllMemberships=[K,true];U.RemoveAllPinnedLinks=[K,true];U.RemoveColleague=[K,true];U.RemoveLink=[K,true];U.RemoveMembership=[K,true];U.RemovePinnedLink=[K,true];U.UpdateColleaguePrivacy=[K,true];U.UpdateLink=[K,true];U.UpdateMembershipPrivacy=[K,true];U.UpdatePinnedLink=[K,true];U.DeleteAllVersions=[E,true];U.DeleteVersion=[E,true];U.GetVersions=[E,false];U.RestoreVersion=[E,true];U.AddView=[aF,true];U.DeleteView=[aF,true];U.GetView=[aF,false];U.GetViewHtml=[aF,false];U.GetViewCollection=[aF,false];U.UpdateView=[aF,true];U.UpdateViewHtml=[aF,true];U.AddWebPart=[e,true];U.AddWebPartToZone=[e,true];U.DeleteWebPart=[e,true];U.GetWebPart2=[e,false];U.GetWebPartPage=[e,false];U.GetWebPartProperties=[e,false];U.GetWebPartProperties2=[e,false];U.SaveWebPart2=[e,true];U.CreateContentType=[aC,true];U.GetColumns=[aC,false];U.GetContentType=[aC,false];U.GetContentTypes=[aC,false];U.GetCustomizedPageStatus=[aC,false];U.GetListTemplates=[aC,false];U.GetObjectIdFromUrl=[aC,false];U.GetWeb=[aC,false];U.GetWebCollection=[aC,false];U.GetAllSubWebCollection=[aC,false];U.UpdateColumns=[aC,true];U.UpdateContentType=[aC,true];U.WebUrlFromPageUrl=[aC,false];U.AlterToDo=[F,true];U.ClaimReleaseTask=[F,true];U.GetTemplatesForItem=[F,false];U.GetToDosForItem=[F,false];U.GetWorkflowDataForItem=[F,false];U.GetWorkflowTaskData=[F,false];U.StartWorkflow=[F,true];var T={};T.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";T.footer="</soap:Body></soap:Envelope>";T.payload="";var ac;ao.fn.SPServices=function(aP){var aJ=ao.extend({},ao.fn.SPServices.defaults,aP);for(var aM=0;aM<y.length;aM++){if(typeof aJ[y[aM]]==="string"){aJ[y[aM]]=j(aJ[y[aM]])}}T.opheader="<"+aJ.operation+" ";switch(U[aJ.operation][0]){case b:T.opheader+="xmlns='"+ad+"/soap/2002/1/alerts/' >";ac=ad+"/soap/2002/1/alerts/";break;case m:T.opheader+="xmlns='"+ad+"/soap/meetings/' >";ac=ad+"/soap/meetings/";break;case af:T.opheader+="xmlns='"+ad+"/soap/recordsrepository/' >";ac=ad+"/soap/recordsrepository/";break;case f:T.opheader+="xmlns='"+ad+"/soap/directory/' >";ac=ad+"/soap/directory/";break;case h:T.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";ac="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case am:T.opheader+="xmlns='urn:Microsoft.Search' >";ac="urn:Microsoft.Search/";break;case ak:T.opheader+="xmlns='"+ad+"/diagnostics/' >";ac="http://schemas.microsoft.com/sharepoint/diagnostics/";break;case J:T.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >";ac="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case ai:T.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/publishing/spelling/' >";ac="http://schemas.microsoft.com/sharepoint/publishing/spelling/SpellCheck";break;case o:T.opheader+="xmlns='"+ad+"/taxonomy/soap/' >";ac=ad+"/taxonomy/soap/";break;case l:T.opheader+="xmlns='"+ad+"/soap/directory/' >";ac=ad+"/soap/directory/";break;case K:T.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";ac="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case e:T.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >";ac="http://microsoft.com/sharepoint/webpartpages/";break;case F:T.opheader+="xmlns='"+ad+"/soap/workflow/' >";ac=ad+"/soap/workflow/";break;default:T.opheader+="xmlns='"+ad+"/soap/'>";ac=ad+"/soap/";break}ac+=aJ.operation;T.opfooter="</"+aJ.operation+">";var aH="_vti_bin/"+U[aJ.operation][0]+".asmx";var aL=ao().SPServices.SPGetCurrentSite();var aN=aJ.webURL!==undefined?aJ.webURL:aJ.webUrl;if(aN.charAt(aN.length-1)===Q){aH=aN+aH}else{if(aN.length>0){aH=aN+Q+aH}else{aH=aL+((aL.charAt(aL.length-1)===Q)?aH:(Q+aH))}}T.payload="";switch(aJ.operation){case"GetAlerts":break;case"DeleteAlerts":T.payload+="<IDs>";for(aM=0;aM<aJ.IDs.length;aM++){T.payload+=aB("string",aJ.IDs[aM])}T.payload+="</IDs>";break;case"Mode":break;case"Login":ax(aJ,["username","password"]);break;case"CopyIntoItems":ax(aJ,["SourceUrl"]);T.payload+="<DestinationUrls>";for(aM=0;aM<aJ.DestinationUrls.length;aM++){T.payload+=aB("string",aJ.DestinationUrls[aM])}T.payload+="</DestinationUrls>";ax(aJ,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":ax(aJ,["SourceUrl"]);T.payload+="<DestinationUrls>";for(aM=0;aM<aJ.DestinationUrls.length;aM++){T.payload+=aB("string",aJ.DestinationUrls[aM])}T.payload+="</DestinationUrls>";break;case"GetItem":ax(aJ,["Url","Fields","Stream"]);break;case"GetForm":ax(aJ,["listName","formUrl"]);break;case"GetFormCollection":ax(aJ,["listName"]);break;case"AddAttachment":ax(aJ,["listName","listItemID","fileName","attachment"]);break;case"AddDiscussionBoardItem":ax(aJ,["listName","message"]);break;case"AddList":ax(aJ,["listName","description","templateID"]);break;case"AddListFromFeature":ax(aJ,["listName","description","featureID","templateID"]);break;case"ApplyContentTypeToList":ax(aJ,["webUrl","contentTypeId","listName"]);break;case"CheckInFile":ax(aJ,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":ax(aJ,["pageUrl","checkoutToLocal","lastmodified"]);break;case"CreateContentType":ax(aJ,["listName","displayName","parentType","fields","contentTypeProperties","addToView"]);break;case"DeleteAttachment":ax(aJ,["listName","listItemID","url"]);break;case"DeleteContentType":ax(aJ,["listName","contentTypeId"]);break;case"DeleteContentTypeXmlDocument":ax(aJ,["listName","contentTypeId","documentUri"]);break;case"DeleteList":ax(aJ,["listName"]);break;case"GetAttachmentCollection":ax(aJ,["listName",["listItemID","ID"]]);break;case"GetList":ax(aJ,["listName"]);break;case"GetListAndView":ax(aJ,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":ax(aJ,["listName","contentTypeId"]);break;case"GetListContentTypes":ax(aJ,["listName"]);break;case"GetListItems":ax(aJ,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"GetListItemChanges":ax(aJ,["listName","viewFields","since","contains"]);break;case"GetListItemChangesSinceToken":ax(aJ,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"],{name:"changeToken",sendNull:false},{name:"contains",sendNull:false}]);break;case"GetVersionCollection":ax(aJ,["strlistID","strlistItemID","strFieldName"]);break;case"UndoCheckOut":ax(aJ,["pageUrl"]);break;case"UpdateContentType":ax(aJ,["listName","contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields","addToView"]);break;case"UpdateContentTypesXmlDocument":ax(aJ,["listName","newDocument"]);break;case"UpdateContentTypeXmlDocument":ax(aJ,["listName","contentTypeId","newDocument"]);break;case"UpdateList":ax(aJ,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":ax(aJ,["listName"]);if(typeof aJ.updates!=="undefined"&&aJ.updates.length>0){ax(aJ,["updates"])}else{T.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+aJ.batchCmd+"'>";for(aM=0;aM<aJ.valuepairs.length;aM++){T.payload+="<Field Name='"+aJ.valuepairs[aM][0]+"'>"+L(aJ.valuepairs[aM][1])+"</Field>"}if(aJ.batchCmd!=="New"){T.payload+="<Field Name='ID'>"+aJ.ID+"</Field>"}T.payload+="</Method></Batch></updates>"}break;case"AddMeeting":ax(aJ,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":ax(aJ,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":ax(aJ,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":ax(aJ,["title"]);break;case"GetRecordRouting":ax(aJ,["recordRouting"]);break;case"GetRecordRoutingCollection":break;case"GetServerInfo":break;case"SubmitFile":ax(aJ,["fileToSubmit"],["properties"],["recordRouting"],["sourceUrl"],["userName"]);break;case"ResolvePrincipals":ax(aJ,["principalKeys","principalType","addToUserInfoList"]);break;case"SearchPrincipals":ax(aJ,["searchText","maxResults","principalType"]);break;case"AddPermission":ax(aJ,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":ax(aJ,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":ax(aJ,["objectName","objectType"]);break;case"RemovePermission":ax(aJ,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":ax(aJ,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":ax(aJ,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":T.opheader="<"+aJ.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";ac="http://microsoft.com/webservices/OfficeServer/QueryService/"+aJ.operation;break;case"GetQuerySuggestions":T.opheader="<"+aJ.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";ac="http://microsoft.com/webservices/OfficeServer/QueryService/"+aJ.operation;T.payload+=aB("queryXml",j(aJ.queryXml));break;case"GetSearchMetadata":T.opheader="<"+aJ.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";ac="http://microsoft.com/webservices/OfficeServer/QueryService/"+aJ.operation;break;case"Query":T.payload+=aB("queryXml",j(aJ.queryXml));break;case"QueryEx":T.opheader="<"+aJ.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";ac="http://microsoft.com/webservices/OfficeServer/QueryService/"+aJ.operation;T.payload+=aB("queryXml",j(aJ.queryXml));break;case"Registration":T.payload+=aB("registrationXml",j(aJ.registrationXml));break;case"Status":break;case"SendClientScriptErrorReport":ax(aJ,["message","file","line","client","stack","team","originalFile"]);break;case"EnumerateFolder":ax(aJ,["strFolderUrl"]);break;case"GetAttachments":ax(aJ,["strListName","strItemId"]);break;case"SiteDataGetList":ax(aJ,["strListName"]);T=k(T,aJ.operation);break;case"SiteDataGetListCollection":T=k(T,aJ.operation);break;case"SiteDataGetSite":T=k(T,aJ.operation);break;case"SiteDataGetSiteUrl":ax(aJ,["Url"]);T=k(T,aJ.operation);break;case"SiteDataGetWeb":T=k(T,aJ.operation);break;case"CreateWeb":ax(aJ,["url","title","description","templateName","language","languageSpecified","locale","localeSpecified","collationLocale","collationLocaleSpecified","uniquePermissions","uniquePermissionsSpecified","anonymous","anonymousSpecified","presence","presenceSpecified"]);break;case"DeleteWeb":ax(aJ,["url"]);break;case"GetSite":ax(aJ,["SiteUrl"]);break;case"GetSiteTemplates":ax(aJ,["LCID","TemplateList"]);break;case"AddComment":ax(aJ,["url","comment","isHighPriority","title"]);break;case"AddTag":ax(aJ,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":ax(aJ,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":ax(aJ,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":ax(aJ,["userAccountName","url"]);break;case"CountCommentsOnUrl":ax(aJ,["url"]);break;case"CountRatingsOnUrl":ax(aJ,["url"]);break;case"CountTagsOfUser":ax(aJ,["userAccountName"]);break;case"DeleteComment":ax(aJ,["url","lastModifiedTime"]);break;case"DeleteRating":ax(aJ,["url"]);break;case"DeleteTag":ax(aJ,["url","termID"]);break;case"DeleteTagByKeyword":ax(aJ,["url","keyword"]);break;case"DeleteTags":ax(aJ,["url"]);break;case"GetAllTagTerms":ax(aJ,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":ax(aJ,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":ax(aJ,["termID"]);break;case"GetAllTagUrlsByKeyword":ax(aJ,["keyword"]);break;case"GetCommentsOfUser":ax(aJ,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":ax(aJ,["userAccountName","url"]);break;case"GetCommentsOnUrl":ax(aJ,["url","maximumItemsToReturn","startIndex"]);if(typeof aJ.excludeItemsTime!=="undefined"&&aJ.excludeItemsTime.length>0){T.payload+=aB("excludeItemsTime",aJ.excludeItemsTime)}break;case"GetRatingAverageOnUrl":ax(aJ,["url"]);break;case"GetRatingOfUserOnUrl":ax(aJ,["userAccountName","url"]);break;case"GetRatingOnUrl":ax(aJ,["url"]);break;case"GetRatingsOfUser":ax(aJ,["userAccountName"]);break;case"GetRatingsOnUrl":ax(aJ,["url"]);break;case"GetSocialDataForFullReplication":ax(aJ,["userAccountName"]);break;case"GetTags":ax(aJ,["url"]);break;case"GetTagsOfUser":ax(aJ,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":ax(aJ,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":ax(aJ,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":ax(aJ,["url","maximumItemsToReturn"]);break;case"GetTagUrls":ax(aJ,["termID"]);break;case"GetTagUrlsByKeyword":ax(aJ,["keyword"]);break;case"GetTagUrlsOfUser":ax(aJ,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":ax(aJ,["keyword","userAccountName"]);break;case"SetRating":ax(aJ,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":ax(aJ,["url","lastModifiedTime","comment","isHighPriority"]);break;case"SpellCheck":ax(aJ,["chunksToSpell","declaredLanguage","useLad"]);break;case"AddTerms":ax(aJ,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":ax(aJ,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":ax(aJ,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":ax(aJ,["termIds","lcid"]);break;case"GetTermsByLabel":ax(aJ,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":ax(aJ,["sharedServiceIds","termSetIds","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":ax(aJ,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","description"]);break;case"AddGroupToRole":ax(aJ,["groupName","roleName"]);break;case"AddRole":ax(aJ,["roleName","description","permissionMask"]);break;case"AddRoleDef":ax(aJ,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":ax(aJ,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":ax(aJ,["roleName","usersInfoXml"]);break;case"AddUserToGroup":ax(aJ,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":ax(aJ,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":ax(aJ,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":ax(aJ,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":ax(aJ,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":ax(aJ,["groupName"]);break;case"GetRoleCollection":ax(aJ,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":ax(aJ,["groupName"]);break;case"GetRoleCollectionFromUser":ax(aJ,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":ax(aJ,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":ax(aJ,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":ax(aJ,["groupName"]);break;case"GetUserCollectionFromRole":ax(aJ,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":ax(aJ,["userLoginName"]);break;case"GetUserLoginFromEmail":ax(aJ,["emailXml"]);break;case"RemoveGroup":ax(aJ,["groupName"]);break;case"RemoveGroupFromRole":ax(aJ,["roleName","groupName"]);break;case"RemoveRole":ax(aJ,["roleName"]);break;case"RemoveUserCollectionFromGroup":ax(aJ,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":ax(aJ,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":ax(aJ,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":ax(aJ,["groupName","userLoginName"]);break;case"RemoveUserFromRole":ax(aJ,["roleName","userLoginName"]);break;case"RemoveUserFromSite":ax(aJ,["userLoginName"]);break;case"RemoveUserFromWeb":ax(aJ,["userLoginName"]);break;case"UpdateGroupInfo":ax(aJ,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":ax(aJ,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":ax(aJ,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":ax(aJ,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":ax(aJ,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":ax(aJ,["accountName","name","url","group","privacy"]);break;case"AddMembership":ax(aJ,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":ax(aJ,["accountName","name","url"]);break;case"CreateMemberGroup":ax(aJ,["membershipInfo"]);break;case"CreateUserProfileByAccountName":ax(aJ,["accountName"]);break;case"GetCommonColleagues":ax(aJ,["accountName"]);break;case"GetCommonManager":ax(aJ,["accountName"]);break;case"GetCommonMemberships":ax(aJ,["accountName"]);break;case"GetInCommon":ax(aJ,["accountName"]);break;case"GetPropertyChoiceList":ax(aJ,["propertyName"]);break;case"GetUserColleagues":ax(aJ,["accountName"]);break;case"GetUserLinks":ax(aJ,["accountName"]);break;case"GetUserMemberships":ax(aJ,["accountName"]);break;case"GetUserPinnedLinks":ax(aJ,["accountName"]);break;case"GetUserProfileByGuid":ax(aJ,["guid"]);break;case"GetUserProfileByIndex":ax(aJ,["index"]);break;case"GetUserProfileByName":if(typeof aJ.accountName!=="undefined"&&aJ.accountName.length>0){ax(aJ,[["AccountName","accountName"]])}else{ax(aJ,["AccountName"])}break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"GetUserPropertyByAccountName":ax(aJ,["accountName","propertyName"]);break;case"ModifyUserPropertyByAccountName":ax(aJ,["accountName","newData"]);break;case"RemoveAllColleagues":ax(aJ,["accountName"]);break;case"RemoveAllLinks":ax(aJ,["accountName"]);break;case"RemoveAllMemberships":ax(aJ,["accountName"]);break;case"RemoveAllPinnedLinks":ax(aJ,["accountName"]);break;case"RemoveColleague":ax(aJ,["accountName","colleagueAccountName"]);break;case"RemoveLink":ax(aJ,["accountName","id"]);break;case"RemoveMembership":ax(aJ,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":ax(aJ,["accountName","id"]);break;case"UpdateColleaguePrivacy":ax(aJ,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":ax(aJ,["accountName","data"]);break;case"UpdateMembershipPrivacy":ax(aJ,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":ax(aJ,["accountName","data"]);break;case"DeleteAllVersions":ax(aJ,["fileName"]);break;case"DeleteVersion":ax(aJ,["fileName","fileVersion"]);break;case"GetVersions":ax(aJ,["fileName"]);break;case"RestoreVersion":ax(aJ,["fileName","fileVersion"]);break;case"AddView":ax(aJ,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":ax(aJ,["listName","viewName"]);break;case"GetView":ax(aJ,["listName","viewName"]);break;case"GetViewCollection":ax(aJ,["listName"]);break;case"GetViewHtml":ax(aJ,["listName","viewName"]);break;case"UpdateView":ax(aJ,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":ax(aJ,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":ax(aJ,["pageUrl","webPartXml","storage"]);break;case"AddWebPartToZone":ax(aJ,["pageUrl","webPartXml","storage","zoneId","zoneIndex"]);break;case"DeleteWebPart":ax(aJ,["pageUrl","storageKey","storage"]);break;case"GetWebPart2":ax(aJ,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":ax(aJ,["documentName","behavior"]);break;case"GetWebPartProperties":ax(aJ,["pageUrl","storage"]);break;case"GetWebPartProperties2":ax(aJ,["pageUrl","storage","behavior"]);break;case"SaveWebPart2":ax(aJ,["pageUrl","storageKey","webPartXml","storage","allowTypeChange"]);break;case"Webs.CreateContentType":ax(aJ,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":ax(aJ,["webUrl"]);break;case"GetContentType":ax(aJ,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":ax(aJ,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":ax(aJ,["objectUrl"]);break;case"GetWeb":ax(aJ,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":ax(aJ,["newFields","updateFields","deleteFields"]);break;case"Webs.UpdateContentType":ax(aJ,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":ax(aJ,[["pageUrl","pageURL"]]);break;case"AlterToDo":ax(aJ,["item","todoId","todoListId","taskData"]);break;case"ClaimReleaseTask":ax(aJ,["item","taskId","listId","fClaim"]);break;case"GetTemplatesForItem":ax(aJ,["item"]);break;case"GetToDosForItem":ax(aJ,["item"]);break;case"GetWorkflowDataForItem":ax(aJ,["item"]);break;case"GetWorkflowTaskData":ax(aJ,["item","listId","taskId"]);break;case"StartWorkflow":ax(aJ,["item","templateId","workflowParameters"]);break;default:break}var aK=T.header+T.opheader+T.payload+T.opfooter+T.footer;var aO;if(aJ.cacheXML){aO=B[aK]}if(typeof aO==="undefined"){var aI=ao.ajax({url:aH,async:aJ.async,beforeSend:function(i){if(U[aJ.operation][1]){i.setRequestHeader("SOAPAction",ac)}},type:"POST",data:aK,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:function(aQ,i){if(ao.isFunction(aJ.completefunc)){aJ.completefunc(aQ,i)}}});if(aJ.cacheXML){B[aK]=aI}return aI}else{if(ao.isFunction(aJ.completefunc)){aO.done(function(aR,i,aQ){aJ.completefunc(aQ,i)})}return aO}};ao.fn.SPServices.defaults={cacheXML:false,operation:"",webURL:"",makeViewDefault:false,viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],DestinationUrls:[],behavior:"Version3",storage:"Shared",objectType:"List",cancelMeeting:true,nonGregorian:false,fClaim:false,recurrenceId:0,sequence:0,maximumItemsToReturn:0,startIndex:0,isHighPriority:false,isPrivate:false,rating:1,maxResults:10,principalType:"User",async:true,completefunc:null};ao.fn.SPServices.SPGetCurrentSite=function(){if(ae.thisSite.length>0){return ae.thisSite}var i=T.header+"<WebUrlFromPageUrl xmlns='"+ad+"/soap/' ><pageUrl>"+((location.href.indexOf("?")>0)?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+T.footer;ao.ajax({async:false,url:"/_vti_bin/Webs.asmx",type:"POST",data:i,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(aH){ae.thisSite=ao(aH.responseXML).find("WebUrlFromPageUrlResult").text()}});return ae.thisSite};ao.fn.SPServices.SPCascadeDropdowns=function(aP){var aH=ao.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",listName:ao().SPServices.SPListNameFromUrl(),CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",promptText:"",noneText:"(None)",simpleChild:false,selectSingleOption:false,matchOnId:false,completefunc:null,debug:false},aP);var aJ=false;var aN="SPServices.SPCascadeDropdowns";var aK=ao().SPServices.SPDropdownCtl({displayName:aH.parentColumn});if(aK.Obj.html()===null&&aH.debug){X(aN,"parentColumn: "+aH.parentColumn,al);return}var i=ao().SPServices.SPDropdownCtl({displayName:aH.childColumn});if(i.Obj.html()===null&&aH.debug){X(aN,"childColumn: "+aH.childColumn,al);return}if(aH.simpleChild===true&&i.Type===Y.complex){ao().SPServices.SPComplexToSimpleDropdown({listName:aH.listName,columnName:aH.childColumn});i=ao().SPServices.SPDropdownCtl({displayName:aH.childColumn})}var aO,aM;ao().SPServices({operation:"GetList",async:false,cacheXML:true,listName:aH.listName,completefunc:function(aQ){ao(aQ.responseXML).find("Fields").each(function(){ao(this).find("Field[DisplayName='"+aH.childColumn+"']").each(function(){aO=(ao(this).attr("Required")==="TRUE");aM=ao(this).attr("StaticName");return false})})}});var aL={opt:aH,childSelect:i,childColumnStatic:aM,childColumnRequired:aO};var aI=aK.Obj.data("SPCascadeDropdownsChildColumns");if(typeof aI==="undefined"){aK.Obj.data("SPCascadeDropdownsChildColumns",[aL])}else{aI.push(aL);aK.Obj.data("SPCascadeDropdownsChildColumns",aI);aJ=true}if(!aJ){switch(aK.Type){case Y.simple:aK.Obj.bind("change",function(){aE(aK)});break;case Y.complex:aK.optHid.bind("propertychange",function(){aE(aK)});break;case Y.multiSelect:ao(aK.master.candidateControl).bind("dblclick",function(){aE(aK)});ao(aK.master.resultControl).bind("dblclick",function(){aE(aK)});ao(aK.master.addControl).bind("click",function(){aE(aK)});ao(aK.master.removeControl).bind("click",function(){aE(aK)});break;default:break}}aE(aK)};function aE(aJ){var aO="";var aI;var aL=null;var aN;var aK;var aM;var aH;var i=aJ.Obj.data("SPCascadeDropdownsChildColumns");ao(i).each(function(){var aT=this.opt;var aR=this.childSelect;var aW=this.childColumnStatic;var aS=this.childColumnRequired;aI=c(aJ,aT.matchOnId);var aQ=aI.join(ah);if(aJ.Obj.data("SPCascadeDropdown_Selected_"+aW)===aQ){return}aJ.Obj.data("SPCascadeDropdown_Selected_"+aW,aQ);aL=c(aR,true);var aV=(aT.relationshipListSortColumn.length>0)?aT.relationshipListSortColumn:aT.relationshipListChildColumn;var aP="<Query><OrderBy><FieldRef Name='"+aV+"'/></OrderBy><Where><And>";if(aT.CAMLQuery.length>0){aP+="<And>"}if(aI.length===0){aP+="<Eq><FieldRef Name='"+aT.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>"}else{if(aI.length===1){aP+="<Eq><FieldRef Name='"+aT.relationshipListParentColumn+(aT.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+L(aI[0])+"</Value></Eq>"}else{var aU=(aI.length>2);for(O=0;O<(aI.length-1);O++){aP+="<Or>"}for(O=0;O<aI.length;O++){aP+="<Eq><FieldRef Name='"+aT.relationshipListParentColumn+(aT.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+L(aI[O])+"</Value></Eq>";if(O>0&&(O<(aI.length-1))&&aU){aP+="</Or>"}}aP+="</Or>"}}if(aT.CAMLQuery.length>0){aP+=aT.CAMLQuery+"</And>"}aP+="<IsNotNull><FieldRef Name='"+aT.relationshipListChildColumn+"' /></IsNotNull>";aP+="</And></Where></Query>";ao().SPServices({operation:"GetListItems",async:false,webURL:aT.relationshipWebURL,listName:aT.relationshipList,CAMLQuery:aP,CAMLViewFields:"<ViewFields><FieldRef Name='"+aT.relationshipListParentColumn+"' /><FieldRef Name='"+aT.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:aT.CAMLQueryOptions,completefunc:function(aX){ao(aX.responseXML).find("errorstring").each(function(){var aZ="SPServices.SPCascadeDropdowns";var aY=ao(this).text();if(aT.debug&&aY==="One or more field types are not installed properly. Go to the list settings page to delete these fields."){X(aZ,"relationshipListParentColumn: "+aT.relationshipListParentColumn+" or relationshipListChildColumn: "+aT.relationshipListChildColumn,"Not found in relationshipList "+aT.relationshipList)}else{if(aT.debug&&aY==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."){X(aZ,"relationshipList: "+aT.relationshipList,"List not found")}}});switch(aR.Type){case Y.simple:ao(aR.Obj).find("option").remove();if(!aS&&(aT.promptText.length>0)){aR.Obj.append("<option value='0'>"+aT.promptText.replace(/\{0\}/g,aT.childColumn)+"</option>")}else{if(!aS){aR.Obj.append("<option value='0'>"+aT.noneText+"</option>")}}break;case Y.complex:aO=aS?"":aT.noneText+"|0";aR.Obj.val("");break;case Y.multiSelect:ao(aR.master.candidateControl).find("option").remove();aN="";break;default:break}aK=parseFloat(ao(aX.responseXML).SPFilterNode("rs:data").attr("ItemCount"));ao(aX.responseXML).SPFilterNode("z:row").each(function(){var aZ={};var aY=ao(this).attr("ows_"+aT.relationshipListChildColumn);if(typeof aY!=="undefined"&&aY.indexOf(ah)>0){aZ=new n(aY)}else{aZ.id=ao(this).attr("ows_ID");aZ.value=aY}if(isNaN(aZ.id)){aZ.id=ao(this).attr("ows_ID")}aM=aZ.id;aH=aZ.value;switch(aR.Type){case Y.simple:var a0=(ao(this).attr("ows_ID")===aL[0])?" selected='selected'":"";aR.Obj.append("<option"+a0+" value='"+aZ.id+"'>"+aZ.value+"</option>");break;case Y.complex:if(aZ.id===aL[0]){aR.Obj.val(aZ.value)}aO=aO+((aO.length>0)?"|":"")+aZ.value+"|"+aZ.id;break;case Y.multiSelect:ao(aR.master.candidateControl).append("<option value='"+aZ.id+"'>"+aZ.value+"</option>");aN+=aZ.id+"|t"+aZ.value+"|t |t |t";break;default:break}});switch(aR.Type){case Y.simple:aR.Obj.trigger("change");if(aK===1&&aT.selectSingleOption===true){ao(aR.Obj).find("option[value!='0']:first").attr("selected","selected")}break;case Y.complex:aR.Obj.attr("choices",aO);if(aK===1&&aT.selectSingleOption===true){ao(aR.Obj).val(aH);aR.optHid.val(aM)}if(aR.Obj.val()===""){aR.optHid.val("")}break;case Y.multiSelect:aR.master.data="";aR.MultiLookupPickerdata.val(aN);ao(aR.master.resultControl).find("option").each(function(){var aY=ao(this);aY.prop("selected",true);ao(aR.master.candidateControl).find("option[value='"+aY.val()+"']").each(function(){aY.prop("selected",false)})});GipRemoveSelectedItems(aR.master);ao(aR.master.candidateControl).find("option").each(function(){var aY=ao(this);ao(aR.master.resultControl).find("option[value='"+aY.val()+"']").each(function(){aY.remove()})});GipAddSelectedItems(aR.master);aR.master.data=GipGetGroupData(aN);ao(aR.master.candidateControl).trigger("dblclick");break;default:break}}});if(aT.completefunc!==null){aT.completefunc()}})}ao.fn.SPServices.SPComplexToSimpleDropdown=function(aO){var i=ao.extend({},{listName:ao().SPServices.SPListNameFromUrl(),columnName:"",completefunc:null,debug:false},aO);var aJ=ao().SPServices.SPDropdownCtl({displayName:i.columnName});if(aJ.Obj.html()===null&&i.debug){X("SPServices.SPComplexToSimpleDropdown","columnName: "+i.columnName,al);return}if(aJ.Type!==Y.complex){return}var aN=ao(aJ.Obj).attr("choices").split("|");var aI=aJ.optHid.val();var aK=ag("SPComplexToSimpleDropdown",aJ.Obj.attr("title"),i.listName);var aM="<select id='"+aK+"' title='"+i.columnName+"'>";for(O=0;O<aN.length;O=O+2){var aL=(aN[O+1]===aI)?" selected='selected' ":" ";aM+="<option"+aL+"value='"+aN[O+1]+"'>"+aN[O]+"</option>"}aM+="</select>";aJ.Obj.closest("td").prepend(aM);var aH=ao("#"+aK);aJ.Obj.closest("span").find("img").remove();aJ.Obj.closest("span").find("input").hide();aH.change(function(){var aP=ao(this).val();aJ.optHid.val(aP);ao(aJ.Obj).val(ao(this).find("option[value='"+(aP!=="0"?aP:"")+"']").html())});aH.trigger("change");if(i.completefunc!==null){i.completefunc()}};ao.fn.SPServices.SPDisplayRelatedInfo=function(aH){var aJ=ao.extend({},{listName:ao().SPServices.SPListNameFromUrl(),columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",matchOnId:false,completefunc:null,debug:false},aH);var i;var aI=[];var aM;var aL="SPServices.SPDisplayRelatedInfo";var aK=ao().SPServices.SPDropdownCtl({displayName:aJ.columnName});if(aK.Obj.html()===null&&aJ.debug){X(aL,"columnName: "+aJ.columnName,al);return}i=ag("SPDisplayRelatedInfo",aJ.columnName,aJ.listName);ao().SPServices({operation:"GetList",async:false,cacheXML:true,webURL:aJ.relatedWebURL,listName:aJ.relatedList,completefunc:function(aN){ao(aN.responseXML).find("faultcode").each(function(){if(aJ.debug){X(aL,"relatedList: "+aJ.relatedList,"List not found")}});aM=ao(aN.responseXML).find("List");for(O=0;O<aJ.relatedColumns.length;O++){aI[aJ.relatedColumns[O]]=ao(aN.responseXML).find("Fields > Field[Name='"+aJ.relatedColumns[O]+"']")}aI[aJ.relatedListColumn]=ao(aN.responseXML).find("Fields > Field[Name='"+aJ.relatedListColumn+"']")}});switch(aK.Type){case Y.simple:aK.Obj.bind("change",function(){aj(aJ,i,aM,aI)});break;case Y.complex:aK.optHid.bind("propertychange",function(){aj(aJ,i,aM,aI)});break;case Y.multiSelect:if(aJ.debug){X(aL,"columnName: "+aJ.columnName,"Multi-select columns not supported by this function")}break;default:break}aj(aJ,i,aM,aI)};function aj(aI,aM,aO,aJ){var aP;var aL="SPServices.SPDisplayRelatedInfo";var aK=ao().SPServices.SPDropdownCtl({displayName:aI.columnName});aP=c(aK,aI.matchOnId);if(aK.Type===Y.complex&&aI.numChars>0&&aP[0].length<aI.numChars){return}if(aK.Obj.attr("showRelatedSelected")===aP[0]){return}aK.Obj.attr("showRelatedSelected",aP[0]);ao("#"+aM).remove();aK.Obj.parent().append("<div id="+aM+"></div>");var i="<Query><Where>";if(aI.CAMLQuery.length>0){i+="<And>"}var aH=aJ[aI.relatedListColumn].attr("Type");if(aH==="Lookup"){i+="<Eq><FieldRef Name='"+aI.relatedListColumn+(aI.matchOnId?"' LookupId='True'/><Value Type='Integer'>":"'/><Value Type='Text'>")+L(aP[0])+"</Value></Eq>"}else{i+="<Eq><FieldRef Name='"+(aI.matchOnId?"ID' /><Value Type='Counter'>":aI.relatedListColumn+"'/><Value Type='Text'>")+L(aP[0])+"</Value></Eq>"}if(aI.CAMLQuery.length>0){i+=aI.CAMLQuery+"</And>"}i+="</Where></Query>";var aN=" ";for(O=0;O<aI.relatedColumns.length;O++){aN+="<FieldRef Name='"+aI.relatedColumns[O]+"' />"}ao().SPServices({operation:"GetListItems",async:false,webURL:aI.relatedWebURL,listName:aI.relatedList,CAMLQuery:i,CAMLViewFields:"<ViewFields>"+aN+"</ViewFields>",CAMLRowLimit:0,completefunc:function(aR){ao(aR.responseXML).find("errorstring").each(function(){var aS=ao(this).text();if(aI.debug&&aS==="One or more field types are not installed properly. Go to the list settings page to delete these fields."){X(aL,"relatedListColumn: "+aI.relatedListColumn,"Column not found in relatedList "+aI.relatedList)}else{if(aI.debug&&aS==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."){X(aL,"relatedList: "+aI.relatedList,"List not found")}}});var aQ;switch(aI.displayFormat){case"table":aQ="<table>";aQ+="<tr>";for(O=0;O<aI.relatedColumns.length;O++){if(typeof aJ[aI.relatedColumns[O]]==="undefined"&&aI.debug){X(aL,"columnName: "+aI.relatedColumns[O],"Column not found in relatedList");return}aQ+="<th class='"+aI.headerCSSClass+"'>"+aJ[aI.relatedColumns[O]].attr("DisplayName")+"</th>"}aQ+="</tr>";ao(aR.responseXML).SPFilterNode("z:row").each(function(){aQ+="<tr>";for(O=0;O<aI.relatedColumns.length;O++){aQ+="<td class='"+aI.rowCSSClass+"'>"+W(aO,aJ[aI.relatedColumns[O]],ao(this).attr("ows_"+aI.relatedColumns[O]),aI)+"</td>"}aQ+="</tr>"});aQ+="</table>";break;case"list":aQ="<table>";ao(aR.responseXML).SPFilterNode("z:row").each(function(){for(O=0;O<aI.relatedColumns.length;O++){if(typeof aJ[aI.relatedColumns[O]]==="undefined"&&aI.debug){X(aL,"columnName: "+aI.relatedColumns[O],"Column not found in relatedList");return}aQ+="<tr>";aQ+="<th class='"+aI.headerCSSClass+"'>"+aJ[aI.relatedColumns[O]].attr("DisplayName")+"</th>";aQ+="<td class='"+aI.rowCSSClass+"'>"+W(aO,aJ[aI.relatedColumns[O]],ao(this).attr("ows_"+aI.relatedColumns[O]),aI)+"</td>";aQ+="</tr>"}});aQ+="</table>";break;default:break}ao("#"+aM).html(aQ)}});if(aI.completefunc!==null){aI.completefunc()}}ao.fn.SPServices.SPFilterDropdown=function(aQ){var aH=ao.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListColumn:"",relationshipListSortColumn:"",relationshipListSortAscending:true,columnName:"",listName:ao().SPServices.SPListNameFromUrl(),promptText:"",noneText:"(None)",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns><ViewAttributes Scope='RecursiveAll'/></QueryOptions>",completefunc:null,debug:false},aQ);var aP="";var aO=null;var aN;var aM;var aL="SPServices.SPFilterDropdown";var aK=ao().SPServices.SPDropdownCtl({displayName:aH.columnName});if(aK.Obj.html()===null&&aH.debug){X(aL,"columnName: "+aH.columnName,al);return}aO=c(aK,true);var aJ=(aH.relationshipListSortColumn.length>0)?aH.relationshipListSortColumn:aH.relationshipListColumn;var aI=(aH.relationshipListSortAscending===true)?"":"Ascending='FALSE'";var i="<Query><OrderBy><FieldRef Name='"+aJ+"' "+aI+"/></OrderBy><Where>";if(aH.CAMLQuery.length>0){i+=aH.CAMLQuery}i+="</Where></Query>";ao().SPServices({operation:"GetList",async:false,cacheXML:true,listName:aH.listName,completefunc:function(aR){ao(aR.responseXML).find("Fields").each(function(){ao(this).find("Field[DisplayName='"+aH.columnName+"']").each(function(){aM=(ao(this).attr("Required")==="TRUE");return false})})}});ao().SPServices({operation:"GetListItems",async:false,webURL:aH.relationshipWebURL,listName:aH.relationshipList,CAMLQuery:i,CAMLViewFields:"<ViewFields><FieldRef Name='"+aH.relationshipListColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:aH.CAMLQueryOptions,completefunc:function(aR){ao(aR.responseXML).find("errorstring").each(function(){var aS=ao(this).text();if(aH.debug&&aS==="One or more field types are not installed properly. Go to the list settings page to delete these fields."){X(aL,"relationshipListColumn: "+aH.relationshipListColumn,"Not found in relationshipList "+aH.relationshipList)}else{if(aH.debug&&aS==="Guid should contain 32 digits with 4 dashes (xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx)."){X(aL,"relationshipList: "+aH.relationshipList,"List not found")}}});switch(aK.Type){case Y.simple:ao(aK.Obj).find("option").remove();if(!aM&&(aH.promptText.length>0)){aK.Obj.append("<option value='0'>"+aH.promptText.replace(/\{0\}/g,aH.columnName)+"</option>")}else{if(!aM){aK.Obj.append("<option value='0'>"+aH.noneText+"</option>")}}break;case Y.complex:aP=aM?"":aH.noneText+"|0";aK.Obj.val("");break;case Y.multiSelect:ao(aK.master.candidateControl).find("option").remove();aN="";break;default:break}ao(aR.responseXML).SPFilterNode("z:row").each(function(){var aT={};var aS=ao(this).attr("ows_"+aH.relationshipListColumn);if(typeof aS!=="undefined"&&aS.indexOf(ah)>0){aT=new n(aS)}else{aT.id=ao(this).attr("ows_ID");aT.value=aS}if(isNaN(aT.id)){aT.id=ao(this).attr("ows_ID")}switch(aK.Type){case Y.simple:var aU=(ao(this).attr("ows_ID")===aO[0])?" selected='selected'":"";aK.Obj.append("<option"+aU+" value='"+aT.id+"'>"+aT.value+"</option>");break;case Y.complex:if(aT.id===aO[0]){aK.Obj.val(aT.value)}aP=aP+((aP.length>0)?"|":"")+aT.value+"|"+aT.id;break;case Y.multiSelect:ao(aK.master.candidateControl).append("<option value='"+aT.id+"'>"+aT.value+"</option>");aN+=aT.id+"|t"+aT.value+"|t |t |t";break;default:break}});switch(aK.Type){case Y.simple:aK.Obj.trigger("change");break;case Y.complex:aK.Obj.attr("choices",aP);aK.Obj.trigger("propertychange");break;case Y.multiSelect:aK.master.data="";aK.MultiLookupPickerdata.val(aN);ao(aK.master.resultControl).find("option").each(function(){var aS=ao(this);ao(this).attr("selected","selected");ao(aK.master.candidateControl).find("option").each(function(){if(ao(this).html()===aS.html()){aS.removeAttr("selected")}})});GipRemoveSelectedItems(aK.master);ao(aK.master.candidateControl).find("option").each(function(){var aS=ao(this);ao(aK.master.resultControl).find("option").each(function(){if(ao(this).html()===aS.html()){aS.remove()}})});GipAddSelectedItems(aK.master);aK.master.data=GipGetGroupData(aN);ao(aK.master.candidateControl).trigger("dblclick");break;default:break}}});if(aH.completefunc!==null){aH.completefunc()}};ao.fn.SPServices.SPDebugXMLHttpResult=function(aI){var aK=ao.extend({},{node:null,indent:0},aI);var aJ;var aM=3;var aL=4;var aH="";aH+="<table class='ms-vb' style='margin-left:"+aK.indent*3+"px;' width='100%'>";if(aK.node.nodeName==="DisplayPattern"){aH+="<tr><td width='100px' style='font-weight:bold;'>"+aK.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+aK.node.xml+"</textarea></td></tr>"}else{if(!aK.node.hasChildNodes()){aH+="<tr><td width='100px' style='font-weight:bold;'>"+aK.node.nodeName+"</td><td>"+((aK.node.nodeValue!==null)?M(aK.node.nodeValue):"&nbsp;")+"</td></tr>";if(aK.node.attributes){aH+="<tr><td colspan='99'>"+s(aK.node)+"</td></tr>"}}else{if(aK.node.hasChildNodes()&&aK.node.firstChild.nodeType===aL){aH+="<tr><td width='100px' style='font-weight:bold;'>"+aK.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+aK.node.parentNode.text+"</textarea></td></tr>"}else{if(aK.node.hasChildNodes()&&aK.node.firstChild.nodeType===aM){aH+="<tr><td width='100px' style='font-weight:bold;'>"+aK.node.nodeName+"</td><td>"+M(aK.node.firstChild.nodeValue)+"</td></tr>"}else{aH+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+aK.node.nodeName+"</td></tr>";if(aK.node.attributes){aH+="<tr><td colspan='99'>"+s(aK.node)+"</td></tr>"}aH+="<tr><td>";for(aJ=0;aJ<aK.node.childNodes.length;aJ++){aH+=ao().SPServices.SPDebugXMLHttpResult({node:aK.node.childNodes.item(aJ),indent:aK.indent+1})}aH+="</td></tr>"}}}}aH+="</table>";return aH};ao.fn.SPServices.SPGetCurrentUser=function(aK){var aM=ao.extend({},{webURL:"",fieldName:"Name",fieldNames:{},debug:false},aK);if(aM.fieldName==="ID"&&typeof ae.thisUserId!=="undefined"){return ae.thisUserId}var aI="";var aL={};var aN=aM.fieldNames.length>0?aM.fieldNames.length:1;var aJ;var aH=aM.webURL.length>0?aM.webURL:ao().SPServices.SPGetCurrentSite();ao.ajax({async:false,url:((aH==="/")?"":aH)+"/_layouts/userdisp.aspx?Force=True&"+new Date().getTime(),complete:function(aO){aJ=aO}});for(O=0;O<aN;O++){if(aM.fieldNames[O]==="ID"){aI=ae.thisUserId}else{var i;if(aN>1){i=RegExp('FieldInternalName="'+aM.fieldNames[O]+'"',"gi")}else{i=RegExp('FieldInternalName="'+aM.fieldName+'"',"gi")}ao(aJ.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(i.test(ao(this).html())){switch(ao(this).attr("id")){case"SPFieldText":aI=ao(this).text();break;case"SPFieldNote":aI=ao(this).find("div").html();break;case"SPFieldURL":aI=ao(this).find("img").attr("src");break;default:aI=ao(this).text();break}return false}})}if(aM.fieldNames[O]!=="ID"){aI=(typeof aI!=="undefined")?aI.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null}if(aN>1){aL[aM.fieldNames[O]]=aI}}return(aN>1)?aL:aI};ao.fn.SPServices.SPLookupAddNew=function(aO){var aJ=ao.extend({},{lookupColumn:"",promptText:"Add new {0}",newWindow:false,ContentTypeID:"",completefunc:null,debug:false},aO);var aL="SPServices.SPLookupAddNew";var aI=ao().SPServices.SPDropdownCtl({displayName:aJ.lookupColumn});if(aI.Obj.html()===null&&aJ.debug){X(aL,"lookupColumn: "+aJ.lookupColumn,al);return}var i="";var aN="";var aH="";ao().SPServices({operation:"GetList",async:false,cacheXML:true,listName:ao().SPServices.SPListNameFromUrl(),completefunc:function(aP){ao(aP.responseXML).find("Field[DisplayName='"+aJ.lookupColumn+"']").each(function(){aH=ao(this).attr("StaticName");ao().SPServices({operation:"GetList",async:false,cacheXML:true,listName:ao(this).attr("List"),completefunc:function(aQ){ao(aQ.responseXML).find("List").each(function(){aN=ao(this).attr("WebFullUrl");aN=aN!==Q?aN+Q:aN})}});i=D(ao(this).attr("List"),"NewForm");return false})}});if(aN.length===0&&aJ.debug){X(aL,"lookupColumn: "+aJ.lookupColumn,"This column does not appear to be a lookup column");return}if(i.length>0){var aM=aN+i;aM+=aJ.newWindow?((aJ.ContentTypeID.length>0)?"?ContentTypeID="+aJ.ContentTypeID:"")+"' target='_blank'":"?"+((aJ.ContentTypeID.length>0)?"ContentTypeID="+aJ.ContentTypeID+"&":"")+"Source="+A(location.href)+"'";var aK="<div id='SPLookupAddNew_"+aH+"'><a href='"+aM+">"+aJ.promptText.replace(/\{0\}/g,aJ.lookupColumn)+"</a></div>";ao(aI.Obj).parents("td.ms-formbody").append(aK)}else{if(aJ.debug){X(aL,"lookupColumn: "+aJ.lookupColumn,"NewForm cannot be found");return}}if(aJ.completefunc!==null){aJ.completefunc()}};ao.fn.SPServices.SPGetLastItemId=function(aH){var aJ=ao.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},aH);var aI;var aK=0;ao().SPServices({operation:"GetUserInfo",webURL:aJ.webURL,async:false,userLoginName:(aJ.userAccount!=="")?aJ.userAccount:ao().SPServices.SPGetCurrentUser(),completefunc:function(aL){ao(aL.responseXML).find("User").each(function(){aI=ao(this).attr("ID")})}});var i="<Query><Where>";if(aJ.CAMLQuery.length>0){i+="<And>"}i+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+aI+"</Value></Eq>";if(aJ.CAMLQuery.length>0){i+=aJ.CAMLQuery+"</And>"}i+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>";ao().SPServices({operation:"GetListItems",async:false,webURL:aJ.webURL,listName:aJ.listName,CAMLQuery:i,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(aL){ao(aL.responseXML).SPFilterNode("z:row").each(function(){aK=ao(this).attr("ows_ID")})}});return aK};ao.fn.SPServices.SPRequireUnique=function(aH){var aI=ao.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:false,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",showDupes:false,completefunc:null},aH);var aM=ao().SPServices.SPGetQueryString();var aN=aM.ID;ae.thisList=ao().SPServices.SPListNameFromUrl();var aL="<span id='SPRequireUnique"+aI.columnStaticName+"' class='{0}'>{1}</span><br/>";var aK=aL.replace(/\{0\}/g,aI.initMsgCSSClass).replace(/\{1\}/g,aI.initMsg);var aJ=ao().SPServices.SPGetDisplayFromStatic({listName:ae.thisList,columnStaticName:aI.columnStaticName});var i=z(aJ).find("input[Title^='"+aJ+"']");i.parent().append(aK);i.blur(function(){var aR=[];var aS=ao(this).val();if(aS.length===0){return false}ao().SPServices({operation:"GetListItems",async:false,listName:ae.thisList,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+aI.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+aI.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(aU){var aT=aI.ignoreCase?aS.toUpperCase():aS;ao(aU.responseXML).SPFilterNode("z:row").each(function(){var aV=aI.ignoreCase?ao(this).attr("ows_"+aI.columnStaticName).toUpperCase():ao(this).attr("ows_"+aI.columnStaticName);if((aT===aV)&&(ao(this).attr("ows_ID")!==aN)){aR.push([ao(this).attr("ows_ID"),ao(this).attr("ows_"+aI.columnStaticName)])}})}});var aP=aI.initMsg;var aQ=ao("#SPRequireUnique"+aI.columnStaticName);aQ.html(aP).attr("class",aI.initMsgCSSClass);ao("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled");if(aR.length>0){aP=aI.errMsg;aQ.html(aP).attr("class",aI.errMsgCSSClass);if(aI.duplicateAction===1){i.focus();ao("input[value='OK'], input[value='Save']").attr("disabled","disabled")}if(aI.showDupes){var aO=" "+aR.length+" duplicate item"+(aR.length>1?"s":"")+": ";for(O=0;O<aR.length;O++){aO+="<a href='DispForm.aspx?ID="+aR[O][0]+"&Source="+location.href+"'>"+aR[O][1]+"</a> "}ao("span#SPRequireUnique"+aI.columnStaticName).append(aO)}}});if(aI.completefunc!==null){aI.completefunc()}};ao.fn.SPServices.SPGetDisplayFromStatic=function(aH){var aI=ao.extend({},{webURL:"",listName:"",columnStaticName:"",columnStaticNames:{}},aH);var i="";var aJ={};var aK=aI.columnStaticNames.length>0?aI.columnStaticNames.length:1;ao().SPServices({operation:"GetList",async:false,cacheXML:true,webURL:aI.webURL,listName:aI.listName,completefunc:function(aL){if(aK>1){for(O=0;O<aK;O++){aJ[aI.columnStaticNames[O]]=ao(aL.responseXML).find("Field[StaticName='"+aI.columnStaticNames[O]+"']").attr("DisplayName")}}else{i=ao(aL.responseXML).find("Field[StaticName='"+aI.columnStaticName+"']").attr("DisplayName")}}});return(aK>1)?aJ:i};ao.fn.SPServices.SPGetStaticFromDisplay=function(i){var aI=ao.extend({},{webURL:"",listName:"",columnDisplayName:"",columnDisplayNames:{}},i);var aH="";var aJ={};var aK=aI.columnDisplayNames.length>0?aI.columnDisplayNames.length:1;ao().SPServices({operation:"GetList",async:false,cacheXML:true,webURL:aI.webURL,listName:aI.listName,completefunc:function(aL){if(aK>1){for(O=0;O<aK;O++){aJ[aI.columnDisplayNames[O]]=ao(aL.responseXML).find("Field[DisplayName='"+aI.columnDisplayNames[O]+"']").attr("StaticName")}}else{aH=ao(aL.responseXML).find("Field[DisplayName='"+aI.columnDisplayName+"']").attr("StaticName")}}});return(aK>1)?aJ:aH};ao.fn.SPServices.SPRedirectWithID=function(aI){var aJ=ao.extend({},{redirectUrl:"",qsParamName:"ID"},aI);ae.thisList=ao().SPServices.SPListNameFromUrl();var aN=ao().SPServices.SPGetQueryString();var aM=aN.ID;var aL=aN.List;var aH=aN.RootFolder;var aK=aN.ContentTypeId;if(typeof aN.ID==="undefined"){aM=ao().SPServices.SPGetLastItemId({listName:ae.thisList});ao("form[id='aspnetForm']").each(function(){var aP=(location.href.indexOf("?")>0)?location.href.substring(0,location.href.indexOf("?")):location.href;var aQ=(typeof aN.Source==="string")?"Source="+aN.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"";var aO=[];if(typeof aL!=="undefined"){aO.push("List="+aL)}if(typeof aH!=="undefined"){aO.push("RootFolder="+aH)}if(typeof aK!=="undefined"){aO.push("ContentTypeId="+aK)}var aR=aP+((aO.length>0)?("?"+aO.join("&")+"&"):"?")+"Source="+aP+"?ID="+aM+((aQ.length>0)?("%26RealSource="+aN.Source):"")+((typeof aN.RedirectURL==="string")?("%26RedirectURL="+aN.RedirectURL):"");setTimeout(function(){document.forms.aspnetForm.action=aR},0)})}else{while(aN.ID===aM){aM=ao().SPServices.SPGetLastItemId({listName:ae.thisList})}var i=(typeof aN.RedirectURL==="string")?aN.RedirectURL:aJ.redirectUrl;location.href=i+"?"+aJ.qsParamName+"="+aM+((typeof aN.RealSource==="string")?("&Source="+aN.RealSource):"")}};ao.fn.SPServices.SPSetMultiSelectSizes=function(aO){var i=ao.extend({},{listName:ao().SPServices.SPListNameFromUrl(),multiSelectColumn:"",minWidth:0,maxWidth:0,debug:false},aO);var aL="SPServices.SPSetMultiSelectSizes";var aK=ao().SPServices.SPDropdownCtl({displayName:i.multiSelectColumn});if(aK.Obj.html()===null&&i.debug){X(aL,"multiSelectColumn: "+i.multiSelectColumn,al);return}if(aK.Type!==Y.multiSelect&&i.debug){X(aL,"multiSelectColumn: "+i.multiSelectColumn,"Column is not multi-select.");return}var aM=ag("SPSetMultiSelectSizes",i.multiSelectColumn,i.listName);var aJ=ao("<select id='"+aM+"' ></select>").appendTo(aK.container);aJ.css({width:"auto",height:0,visibility:"hidden"});ao(aK.master.candidateControl).find("option").each(function(){aJ.append("<option value='"+ao(this).html()+"'>"+ao(this).html()+"</option>")});ao(aK.master.resultControl).find("option").each(function(){aJ.append("<option value='"+ao(this).val()+"'>"+ao(this).html()+"</option>")});var aH=aJ.width()+5;var aN=aH;if(i.minWidth>0||i.maxWidth>0){if(aH<i.minWidth){aH=i.minWidth}if(aN<i.minWidth){aN=i.minWidth}if(aN>i.maxWidth){aN=i.maxWidth}}var aI=aH;ao(aK.master.candidateControl).css("width",aI+"px").parent().css("width",aN+"px");ao(aK.master.resultControl).css("width",aI+"px").parent().css("width",aN+"px");aJ.remove()};ao.fn.SPServices.SPScriptAudit=function(aI){var aJ=ao.extend({},{webURL:"",listName:"",outputId:"",auditForms:true,auditViews:true,auditPages:true,auditPagesListName:"Pages",showHiddenLists:false,showNoScript:false,showSrc:true},aI);var aH=[["New","NewForm.aspx",false],["Display","DispForm.aspx",false],["Edit","EditForm.aspx",false]];var aL;ao("#"+aJ.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(aJ.showSrc?"<th>Script References</th>":"")+"</tr></table>");var aK=ao("#SPScriptAudit");aK.find("th").attr("class","ms-vh2-nofilter");if(aJ.auditForms||aJ.auditViews){ao().SPServices({operation:"GetListCollection",webURL:aJ.webURL,async:false,completefunc:function(aN){ao(aN.responseXML).find("List").each(function(){aL=ao(this);if((aJ.listName.length===0)||(aL.attr("Title")===aJ.listName)){if((aJ.showHiddenLists&&aL.attr("Hidden")==="False")||!aJ.showHiddenLists){if(aJ.auditForms){ao().SPServices({operation:"GetListContentTypes",webURL:aJ.webURL,listName:aL.attr("ID"),async:false,completefunc:function(aO){ao(aO.responseXML).find("ContentType").each(function(){if(ao(this).attr("ID").substring(0,6)!=="0x0120"){var aQ=ao(this).find("FormUrls");for(O=0;O<aH.length;O++){ao(aQ).find(aH[O][0]).each(function(){aD(aJ,aL,"Form",this.nodeName,((aJ.webURL.length>0)?aJ.webURL:ao().SPServices.SPGetCurrentSite())+Q+ao(this).text());aH[O][2]=true});if(!aH[O][2]){var aP=aL.attr("DefaultViewUrl");aD(aJ,aL,"Form",aH[O][0],aP.substring(0,aP.lastIndexOf(Q)+1)+aH[O][1])}}for(O=0;O<aH.length;O++){aH[O][2]=false}}})}})}if(aJ.auditViews){ao().SPServices({operation:"GetViewCollection",webURL:aJ.webURL,listName:aL.attr("ID"),async:false,completefunc:function(aO){ao(aO.responseXML).find("View").each(function(){aD(aJ,aL,"View",ao(this).attr("DisplayName"),ao(this).attr("Url"))})}})}}}})}})}var i=0;var aM=[];if(typeof aJ.auditPagesListName==="string"){i=1;aM.push(aJ.auditPagesListName)}else{i=aJ.auditPagesListName.length;aM=aJ.auditPagesListName}if(aJ.auditPages){for(O=0;O<i;O++){ao().SPServices({operation:"GetList",async:false,cacheXML:true,webURL:aJ.webURL,listName:aM[O],completefunc:function(aN){ao(aN.responseXML).find("List").each(function(){aL=ao(this)})}});ao().SPServices({operation:"GetListItems",async:false,webURL:aJ.webURL,listName:aM[O],CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(aN){ao(aN.responseXML).SPFilterNode("z:row").each(function(){var aQ=ao(this).attr("ows_FileRef").split(ah)[1];var aO=ao(this).attr("ows_Title");var aP=(typeof aO!=="undefined")?aO:"";if(aQ.indexOf(".aspx")>0){aD(aJ,aL,"Page",aP,Q+aQ)}})}})}}aK.find("tr[class='ms-alternating']:even").removeAttr("class")};function aD(aH,aI,aP,aL,aJ){var aM=0;var aO=0;var aK={};aK.type=[];aK.src=[];aK.script=[];var aN=RegExp("<script[\\s\\S]*?/script>","gi");ao.ajax({type:"GET",url:aJ,dataType:"text",async:false,success:function(aV){var aU;while(aU=aN.exec(aV)){var aQ=an(aU,"language");var aW=an(aU,"type");var aS=an(aU,"src");if(aS!==null&&aS.length>0&&!ap(aS)){aK.type.push((aQ!==null&&aQ.length>0)?aQ:aW);aK.src.push(aS);aO++}}if((!aH.showNoScript&&(aK.type.length>0))||aH.showNoScript){var aT=aJ.substring(0,aJ.lastIndexOf(Q)+1);var aR="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+aI.attr("DefaultViewUrl")+"'><IMG border=0 src='"+aI.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+aI.attr("DefaultViewUrl")+"'>"+aI.attr("Title")+((aI.attr("Hidden")==="True")?"(Hidden)":"")+"</td><td class=ms-vb2>"+aP+"</td><td class=ms-vb2>"+aL+"</td><td class=ms-vb2><a href='"+aJ+"'>"+R(aJ)+"</td>";if(aH.showSrc){var i;aR+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(aM=0;aM<aK.type.length;aM++){i=(aK.src[aM].substr(0,1)!==Q)?aT+aK.src[aM]:aK.src[aM];aR+="<tr><td class=ms-vb2 width='30%'>"+aK.type[aM]+"</td>";aR+="<td class=ms-vb2 width='70%'><a href='"+i+"'>"+R(aK.src[aM])+"</td></tr>"}aR+="</table></td>"}ao("#SPScriptAudit").append(aR)}}})}function an(aJ,aH){var aI;var i=RegExp(aH+"=(\"([^\"]*)\")|('([^']*)')","gi");if(aI=i.exec(aJ)){return aI[2]}return null}function ap(aJ){var aI;var aH=["WebResource.axd","_layouts"];for(aI=0;aI<aH.length;aI++){if(aJ.indexOf(aH[aI])>-1){return true}}return false}ao.fn.SPServices.SPArrangeChoices=function(aH){var aI=ao.extend({},{listName:ao().SPServices.SPListNameFromUrl(),columnName:"",perRow:99,randomize:false},aH);var aK=false;var aJ=[];var i=ao().SPServices({operation:"GetList",async:false,cacheXML:true,listName:aI.listName});i.done(function(){ao(i.responseXML).find("Field[DisplayName='"+aI.columnName+"']").each(function(){aK=(ao(this).attr("FillInChoice")==="TRUE");return false});var aR=z(aI.columnName);var aO=ao(aR).find("tr").length;var aQ;var aL;ao(aR).find("tr").each(function(aS){if(aK&&aS===(aO-2)){aQ=ao(this).find("td")}else{if(aK&&aS===(aO-1)){aL=ao(this).find("td")}else{aJ.push(ao(this).find("td"))}}});if(aI.randomize){aJ.sort(q)}var aN=ao("<table cellpadding='0' cellspacing='1'></table>");for(O=0;O<aJ.length;O++){if((O+1)%aI.perRow===0){aN.append("<tr></tr>")}aN.find("tr:last").append(aJ[O])}if(aK){var aM=ao("<tr><td colspan='99'><table cellpadding='0' cellspacing='1'><tr></tr></table></td></tr>");aM.find("tr").append(aQ);aM.find("tr").append(aL);aN.append(aM)}var aP=ao(aR).find("table:first");aP.before(aN);aP.hide()})};ao.fn.SPServices.SPAutocomplete=function(aI){var aJ=ao.extend({},{webURL:"",sourceList:"",sourceColumn:"",columnName:"",listName:ao().SPServices.SPListNameFromUrl(),CAMLQuery:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",CAMLRowLimit:0,filterType:"BeginsWith",numChars:0,ignoreCase:false,highlightClass:"",uniqueVals:false,maxHeight:99999,slideDownSpeed:"fast",processingIndicator:"_layouts/images/REFRESH.GIF",debug:false},aI);var aL;var aH=z(aJ.columnName).find("input[Title^='"+aJ.columnName+"']");aH.css("position","");var aK=aH.css("color");var aN=aH.css("width");if(aH.html()===null&&aJ.debug){X("SPServices.SPAutocomplete","columnName: "+aJ.columnName,"Column is not an input control or is not found on page");return}aH.closest("span").find("br").remove();aH.wrap("<div>");var i=ag("SPAutocomplete",aJ.columnName,aJ.listName);aH.after("<div><ul id='"+i+"' style='width:"+aN+";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>");var aM=ao("#"+i);aM.css("width",aN);ao(aH).keyup(function(){var aW=ao(this).val();aM.hide();if(aW.length<aJ.numChars){return false}aH.css({"background-image":"url("+aJ.processingIndicator+")","background-position":"right","background-repeat":"no-repeat"});var aV=[];var aO="<Query><OrderBy><FieldRef Name='"+aJ.sourceColumn+"'/></OrderBy><Where>";if(aJ.CAMLQuery.length>0){aO+="<And>"}aO+="<"+aJ.filterType+"><FieldRef Name='"+aJ.sourceColumn+"'/><Value Type='Text'>"+aW+"</Value></"+aJ.filterType+">";if(aJ.CAMLQuery.length>0){aO+=aJ.CAMLQuery+"</And>"}aO+="</Where></Query>";ao().SPServices({operation:"GetListItems",async:false,webURL:aJ.WebURL,listName:aJ.sourceList,CAMLQuery:aO,CAMLQueryOptions:aJ.CAMLQueryOptions,CAMLViewFields:"<ViewFields><FieldRef Name='"+aJ.sourceColumn+"' /></ViewFields>",CAMLRowLimit:aJ.CAMLRowLimit,completefunc:function(aZ){var aY=aJ.ignoreCase?aW.toUpperCase():aW;ao(aZ.responseXML).SPFilterNode("z:row").each(function(){var a1=ao(this).attr("ows_"+aJ.sourceColumn);var a2=aJ.ignoreCase?ao(this).attr("ows_"+aJ.sourceColumn).toUpperCase():ao(this).attr("ows_"+aJ.sourceColumn);if(aJ.filterType==="Contains"){var a0=a2.indexOf(aY);if((a0>=0)&&(!aJ.uniqueVals||(ao.inArray(a1,aV)===-1))){aV.push(ao(this).attr("ows_"+aJ.sourceColumn))}}else{if(aY===a2.substr(0,aY.length)&&(!aJ.uniqueVals||(ao.inArray(a1,aV)===-1))){aV.push(ao(this).attr("ows_"+aJ.sourceColumn))}}})}});var aR="";for(O=0;O<aV.length;O++){if(aJ.highlightClass.length>0){var aQ=new RegExp(aW,aJ.ignoreCase?"gi":"g");var aT=aV[O].match(aQ);var aS=0;for(aL=0;aL<aT.length;aL++){var aU=aV[O].indexOf(aT[aL],aS);var aP=aU+aT[aL].length;var aX="<span class='"+aJ.highlightClass+"'>"+aT[aL]+"</span>";aV[O]=aV[O].substr(0,aU)+aX+aV[O].substr(aP);aS=aU+aX.length}}aR+="<li style='display: block;position: relative;cursor: pointer;'>"+aV[O]+"</li>"}aM.html(aR);ao("#"+i+" li").click(function(){ao("#"+i).fadeOut(aJ.slideUpSpeed);aH.val(ao(this).text())}).mouseover(function(){var aY={cursor:"hand",color:"#ffffff",background:"#3399ff"};ao(this).css(aY)}).mouseout(function(){var aY={cursor:"inherit",color:aK,background:"transparent"};ao(this).css(aY)});if(aV.length>0){ao("#"+i).slideDown(aJ.slideDownSpeed)}aH.css("background-image","")})};ao.fn.SPServices.SPGetQueryString=function(aI){var aK=ao.extend({},{lowercase:false},aI);var aN={};var aH=location.search.slice(1).split("&");for(var aJ=0;aJ<aH.length;aJ++){var aM=aH[aJ].split("=");var aL=aK.lowercase?aM[0].toLowerCase():aM[0];aN[aL]=decodeURIComponent(aM[1]||"")}return aN};ao.fn.SPServices.SPListNameFromUrl=function(i){var aH=ao.extend({},{listName:""},i);if(aH.listName.length>0){ae.thisList=aH.listName;return ae.thisList}else{if(ae.thisList!==undefined&&ae.thisList.length>0){return ae.thisList}}var aJ=location.href;var aI=aJ.substring(0,aJ.indexOf(".aspx"));var aK=decodeURIComponent(aI.substring(0,aI.lastIndexOf(Q)+1)).toUpperCase();ao().SPServices({operation:"GetListCollection",async:false,completefunc:function(aL){ao(aL.responseXML).find("List").each(function(){var aM=ao(this).attr("DefaultViewUrl");var aN=aM.substring(0,aM.lastIndexOf(Q)+1).toUpperCase();if(aK.indexOf(aN)>0){ae.thisList=ao(this).attr("ID");return false}})}});return ae.thisList};ao.fn.SPServices.SPUpdateMultipleListItems=function(aJ){var aL=ao.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],completefunc:null,debug:false},aJ);var aK;var aN=[];var aM=[];ao().SPServices({operation:"GetListItems",async:false,webURL:aL.webURL,listName:aL.listName,CAMLQuery:aL.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(i){ao(i.responseXML).SPFilterNode("z:row").each(function(){aN.push(ao(this).attr("ows_ID"));var aO=ao(this).attr("ows_FileRef");aO="/"+aO.substring(aO.indexOf(ah)+2);aM.push(aO)})}});var aH;var aI="<Batch OnError='Continue'>";for(aK=0;aK<aN.length;aK++){aI+="<Method ID='"+aK+"' Cmd='"+aL.batchCmd+"'>";for(aH=0;aH<aL.valuepairs.length;aH++){aI+="<Field Name='"+aL.valuepairs[aH][0]+"'>"+L(aL.valuepairs[aH][1])+"</Field>"}aI+="<Field Name='ID'>"+aN[aK]+"</Field>";if(aM[aK].length>0){aI+="<Field Name='FileRef'>"+aM[aK]+"</Field>"}aI+="</Method>"}aI+="</Batch>";ao().SPServices({operation:"UpdateListItems",async:false,webURL:aL.webURL,listName:aL.listName,updates:aI,completefunc:function(i){if(aL.completefunc!==null){aL.completefunc(i)}}})};ao.fn.SPServices.SPGetListItemsJson=function(aJ){var aK=ao.extend({},{webURL:"",listName:"",viewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:"",CAMLQueryOptions:"",changeToken:"",contains:"",mapping:null,mappingOverrides:null,debug:false},ao().SPServices.defaults,aJ);var aI;var aH={};var aM=[];var i=ao.Deferred();var aL=ao().SPServices({operation:"GetListItemChangesSinceToken",webURL:aK.webURL,listName:aK.listName,viewName:aK.viewName,CAMLQuery:aK.CAMLQuery,CAMLViewFields:aK.CAMLViewFields,CAMLRowLimit:aK.CAMLRowLimit,CAMLQueryOptions:aK.CAMLQueryOptions,changeToken:aK.changeToken,contains:aK.contains});aL.done(function(){var aP="SPGetListItemsJson"+aK.webURL+aK.listName;var aQ=ao(aL.responseXML);aI=aQ.find("Changes").attr("LastChangeToken");aQ.find("listitems Changes Id[ChangeType='Delete']").each(function(){aM.push(ao(this).text())});if(aK.mapping===null){aQ.find("List > Fields > Field").each(function(){var aS=ao(this);var aT=aS.attr("Type");if(ao.inArray(aT,ar)>=0){aH["ows_"+aS.attr("Name")]={mappedName:aS.attr("Name"),objectType:aS.attr("Type")}}})}else{aH=aK.mapping}if(aK.mappingOverrides!==null){for(var aN in aK.mappingOverrides){aH[aN]=aK.mappingOverrides[aN]}}if(ao.isEmptyObject(aH)){aH=ao(document).data(aP)}else{ao(document).data(aP,aH)}var aO=aQ.SPFilterNode("z:row").SPXmlToJson({mapping:aH,sparse:true});var aR={changeToken:aI,mapping:aH,data:aO,deletedIds:aM};i.resolveWith(aR)});return i.promise()};ao.fn.SPServices.SPConvertDateToISO=function(i){var aH=ao.extend({},{dateToConvert:new Date(),dateOffset:"-05:00"},i);var aI="";var aJ=aH.dateToConvert;aI+=aJ.getFullYear()+"-";aI+=u(aJ.getMonth()+1)+"-";aI+=u(aJ.getDate());aI+="T"+u(aJ.getHours())+":";aI+=u(aJ.getMinutes())+":";aI+=u(aJ.getSeconds())+"Z"+aH.dateOffset;return aI};ao.fn.SPFilterNode=function(i){return this.find("*").filter(function(){return this.nodeName===i})};ao.fn.SPXmlToJson=function(i){var aI=ao.extend({},{mapping:{},includeAllAttrs:false,removeOws:true,sparse:false},i);var aJ;var aH=[];this.each(function(){var aN={};var aP=this.attributes;if(!aI.sparse){ao.each(aI.mapping,function(){aN[this.mappedName]=""})}for(aJ=0;aJ<aP.length;aJ++){var aO=aP[aJ].name;var aM=aI.mapping[aO];var aK=typeof aM!=="undefined"?aM.mappedName:aI.removeOws?aO.split("ows_")[1]:aO;var aL=typeof aM!=="undefined"?aM.objectType:undefined;if(aI.includeAllAttrs||aM!==undefined){aN[aK]=N(aP[aJ].value,aL)}}aH.push(aN)});return aH};function N(aH,i){var aI;switch(i){case"Text":aI=aH;break;case"DateTime":case"datetime":aI=d(aH);break;case"User":aI=S(aH);break;case"UserMulti":aI=x(aH);break;case"Lookup":aI=az(aH);break;case"LookupMulti":aI=p(aH);break;case"Boolean":aI=r(aH);break;case"Integer":aI=a(aH);break;case"Counter":aI=a(aH);break;case"MultiChoice":aI=w(aH);break;case"Number":case"Currency":case"float":aI=P(aH);break;case"Calculated":aI=au(aH);break;case"Attachments":aI=aA(aH);break;case"URL":aI=t(aH);break;case"JSON":aI=aw(aH);break;default:aI=aH;break}return aI}function a(i){return parseInt(i,10)}function P(i){return parseFloat(i)}function r(i){return i!=="0"}function d(aI){var aJ=aI.split("T")[0]!==aI?aI.split("T"):aI.split(" ");var aK=aJ[0].split("-");var aH=aJ[1].split(":");var i=aH[2].split("Z");return new Date(aK[0],(aK[1]-1),aK[2],aH[0],aH[1],i[0])}function S(aI){if(aI.length===0){return null}else{var i=new n(aI);var aH=i.value.split(",#");if(aH.length===1){return{userId:i.id,userName:i.value}}else{return{userId:i.id,userName:aH[0].replace(/(,,)/g,","),loginName:aH[1].replace(/(,,)/g,","),email:aH[2].replace(/(,,)/g,","),sipAddress:aH[3].replace(/(,,)/g,","),title:aH[4].replace(/(,,)/g,",")}}}}function x(aI){if(aI.length===0){return null}else{var aJ=[];var aH=aI.split(ah);for(O=0;O<aH.length;O=O+2){var i=S(aH[O]+ah+aH[O+1]);aJ.push(i)}return aJ}}function az(i){if(i.length===0){return null}else{var aH=i.split(ah);return{lookupId:aH[0],lookupValue:aH[1]}}}function p(aH){if(aH.length===0){return null}else{var aJ=[];var i=aH.split(ah);for(O=0;O<i.length;O=O+2){var aI=az(i[O]+ah+i[O+1]);aJ.push(aI)}return aJ}}function w(aI){if(aI.length===0){return null}else{var i=[];var aH=aI.split(ah);for(O=0;O<aH.length;O++){if(aH[O].length!==0){i.push(aH[O])}}return i}}function aA(aI){if(aI.length===0){return null}else{if(aI==="0"||aI==="1"){return aI}else{var aH=[];var i=aI.split(ah);for(O=0;O<i.length;O++){if(i[O].length!==0){var aK=i[O];if(i[O].lastIndexOf("/")!==-1){var aJ=i[O].split("/");aK=aJ[aJ.length-1]}aH.push({attachment:i[O],fileName:aK})}}return aH}}}function t(aH){if(aH.length===0){return null}else{var i=aH.split(", ");return{Url:i[0],Description:i[1]}}}function au(aH){if(aH.length===0){return null}else{var i=aH.split(ah);return N(i[1],i[0])}}function aw(i){if(i.length===0){return null}else{return ao.parseJSON(i)}}ao.fn.SPServices.SPFindPeoplePicker=function(aI){var aJ=ao.extend({},{peoplePickerDisplayName:"",valueToSet:"",checkNames:true},aI);var aM=ao("nobr").filter(function(){return ao(this).contents().eq(0).text()===aJ.peoplePickerDisplayName}).closest("tr");var aH=aM.find("div[name='upLevelDiv']");var i=aM.find("img[Title='Check Names']:first");if(aJ.valueToSet.length>0){aH.html(aJ.valueToSet)}if(aJ.checkNames){i.click()}var aL=ao.trim(aH.text());var aK=[];aH.children("span").each(function(){var aP=ao(this).find("div[data]").attr("data");var aN={};if(typeof aP!=="undefined"){var aQ=ao.parseXML(aP);var aO=ao(aQ);aO.find("DictionaryEntry").each(function(){var aR=ao(this).find("Key").text();aN[aR]=ao(this).find("Value").text()});aK.push(aN)}else{ao().SPServices({operation:"GetUserInfo",async:false,cacheXML:true,userLoginName:ao(this).attr("title"),completefunc:function(aR){ao(aR.responseXML).find("User").each(function(){ao.each(this.attributes,function(aS,aT){aN[aT.name]=aT.value});aK.push(aN)})}})}});return{row:aM,contents:aH,currentValue:aL,checkNames:i,dictionaryEntries:aK}};ao.fn.SPFindPeoplePicker=function(i){return ao().SPServices.SPFindPeoplePicker(i)};ao.fn.SPServices.SPFindMMSPicker=function(aJ){var aL=ao.extend({},{MMSDisplayName:""},aJ);var aI=[];var aH=ao("div[title='"+aL.MMSDisplayName+"']");var aO=aH.closest("td").find("input[type='hidden']");var aN=aO.val().split(";");for(var aK=0;aK<aN.length;aK++){var aM=aN[aK].split("|");aI.push({value:aM[0],guid:aM[1]})}return{terms:aI}};ao.fn.SPServices.Version=function(){return ab};ao.fn.SPServices.SPDropdownCtl=function(aJ){var aK=ao.extend({},{displayName:""},aJ);var aI={};var aM=ao().SPServices.SPGetStaticFromDisplay({listName:ao().SPServices.SPListNameFromUrl(),columnDisplayName:aK.displayName});if((aI.Obj=ao("select[Title='"+aK.displayName+"']")).length===1){aI.Type=Y.simple}else{if((aI.Obj=ao("input[Title='"+aK.displayName+"']")).length===1){aI.Type=Y.complex}else{if((aI.Obj=ao("select:regex(id, ("+aM+")(_)[0-9a-fA-F]{8}(-))")).length===1){aI.Type=Y.simple}else{if((aI.Obj=ao("select[ID$='SelectCandidate'][Title^='"+aK.displayName+" ']")).length===1){aI.Type=Y.multiSelect}else{if((aI.Obj=ao("select[ID$='SelectCandidate'][Title$=': "+aK.displayName+"']")).length===1){aI.Type=Y.multiSelect}else{if((aI.Obj=ao("select[ID$='SelectCandidate'][Title$='\""+aK.displayName+"\".']")).length===1){aI.Type=Y.multiSelect}else{if((aI.Obj=ao("select[ID$='SelectCandidate'][Title$=' "+aK.displayName+"']")).length===1){aI.Type=Y.multiSelect}else{aI.Type=null}}}}}}}if(aI.Type===null){var aL=z(aK.displayName);if(aL!==undefined){var aH=aL.find("select[title^='"+aK.displayName+" '][id$='_Lookup']");if(aH&&aH.length===1){aI.Type=Y.simple;aI.Obj=aH}}}if(aI.Type===Y.complex){aI.optHid=ao("input[id='"+aI.Obj.attr("optHid")+"']")}else{if(aI.Type===Y.multiSelect){aI.container=aI.Obj.closest("span");aI.MultiLookupPickerdata=aI.container.find("input[id$='"+at+"_data'], input[id$='"+g+"_data']");var i=aI.container.find("[id$='AddButton']").attr("id");aI.master=window[i.replace(/AddButton/,at+"_m")]||window[i.replace(/AddButton/,g+"_m")]}}return aI};function av(){var i=location.protocol+"//"+location.host+(location.port!==""?location.port:"");if(typeof _spPageContextInfo!=="undefined"){this.thisSite=i+_spPageContextInfo.webServerRelativeUrl;this.thisList=_spPageContextInfo.pageListId;this.thisUserId=_spPageContextInfo.userId}else{this.thisSite=(typeof L_Menu_BaseUrl!=="undefined")?i+L_Menu_BaseUrl:"";this.thisList="";this.thisUserId=(typeof _spUserId!=="undefined")?_spUserId:undefined}}function W(aS,aO,aT,aJ){if(typeof aT==="undefined"){return""}var aP;var aQ="";var aN;var aL;var aR=[];var aK=aJ.relatedWebURL.length>0?aJ.relatedWebURL:ao().SPServices.SPGetCurrentSite();switch(aO.attr("Type")){case"Text":aQ=aT;break;case"URL":switch(aO.attr("Format")){case"Hyperlink":aQ="<a href='"+aT.substring(0,aT.search(","))+"'>"+aT.substring(aT.search(",")+1)+"</a>";break;case"Image":aQ="<img alt='"+aT.substring(aT.search(",")+1)+"' src='"+aT.substring(0,aT.search(","))+"'/>";break;default:aQ=aT;break}break;case"User":case"UserMulti":var aH=aT.split(ah);for(aP=0;aP<aH.length;aP=aP+2){aR.push("<a href='/_layouts/userdisp.aspx?ID="+aH[aP]+"&Source="+A(location.href)+"'>"+aH[aP+1]+"</a>")}aQ=aR.join(", ");break;case"Calculated":var aM=aT.split(ah);aQ=aM[1];break;case"Number":aL=aO.attr("Decimals");aQ=typeof aL==="undefined"?parseFloat(aT).toString():parseFloat(aT).toFixed(aL).toString();break;case"Currency":aL=aO.attr("Decimals");aQ=typeof aL==="undefined"?parseFloat(aT).toFixed(2).toString():parseFloat(aT).toFixed(aL).toString();break;case"Lookup":switch(aO.attr("Name")){case"FileRef":aN=aS.attr("BaseType")==="1"?aS.attr("RootFolder")+Q+"Forms/DispForm.aspx":aS.attr("RootFolder")+Q+"DispForm.aspx";aQ="<a href='"+aN+"?ID="+aT.substring(0,aT.search(ah))+"&RootFolder=*&Source="+A(location.href)+"'>"+aT.substring(aT.search(ah)+2)+"</a>";break;case"FileDirRef":aN=Q+aT.substring(aT.search(ah)+2);aQ="<a href='"+aN+"'>"+aT.substring(aT.search(ah)+2)+"</a>";break;default:aN=D(aO.attr("List"),"DisplayForm");aQ="<a href='"+aJ.relatedWebURL+Q+aN+"?ID="+aT.substring(0,aT.search(ah))+"&RootFolder=*&Source="+A(location.href)+"'>"+aT.substring(aT.search(ah)+2)+"</a>";break}break;case"LookupMulti":aN=D(aO.attr("List"),"DisplayForm");aQ="";if(aT.length>0){var aI=aT.split(ah);for(aP=0;aP<aI.length/2;aP++){aR.push("<a href='"+aK+Q+aN+"?ID="+aI[aP*2]+"&RootFolder=*&Source="+A(location.href)+"'>"+aI[(aP*2)+1]+"</a>")}}aQ=aR.join(", ");break;case"File":R=aT.substring(aT.search(ah)+2);aQ="<a href='"+aS.attr("RootFolder")+Q+R+"'>"+R+"</a>";break;case"Counter":aQ=aT;break;case"DateTime":aQ=aT;break;default:aQ=aT;break}return aQ}function s(aJ){var aI;var aH="<table class='ms-vb' width='100%'>";for(aI=0;aI<aJ.attributes.length;aI++){aH+="<tr><td width='10px' style='font-weight:bold;'>"+aI+"</td><td width='100px'>"+aJ.attributes.item(aI).nodeName+"</td><td>"+M(aJ.attributes.item(aI).nodeValue)+"</td></tr>"}aH+="</table>";return aH}function c(aI,aH){var i=[];switch(aI.Type){case Y.simple:if(aH){i.push(aI.Obj.find("option:selected").val()||[])}else{i.push(aI.Obj.find("option:selected").text()||[])}break;case Y.complex:if(aH){i.push(aI.optHid.val()||[])}else{i.push(aI.Obj.val()||[])}break;case Y.multiSelect:ao(aI.master.resultControl).find("option").each(function(){if(aH){i.push(ao(this).val())}else{i.push(ao(this).html())}});break;default:break}return i}function X(aH,aJ,aI){var i="<b>Error in function</b><br/>"+aH+"<br/><b>Parameter</b><br/>"+aJ+"<br/><b>Message</b><br/>"+aI+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";V(i)}function V(aM){var aJ="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";ao("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+aJ+">"+aM);var aI=ao("#SPServices_msgBox");var i=aI.height();var aL=aI.width();var aK=(ao(window).width()/2)-(aL/2)+"px";var aH=(ao(window).height()/2)-(i/2)-100+"px";aI.css({border:"5px #C02000 solid",left:aK,top:aH}).show().fadeTo("slow",0.75).click(function(){ao(this).fadeOut("3000",function(){ao(this).remove()})})}function ag(i,aI,aJ){var aH=aJ!==undefined?aJ:ao().SPServices.SPListNameFromUrl();return i+"_"+ao().SPServices.SPGetStaticFromDisplay({listName:aH,columnDisplayName:aI})}function D(i,aI){var aH;ao().SPServices({operation:"GetFormCollection",async:false,listName:i,completefunc:function(aJ){aH=ao(aJ.responseXML).find("Form[Type='"+aI+"']").attr("Url")}});return aH}function ax(aJ,aH){var aI;for(aI=0;aI<aH.length;aI++){if(typeof aH[aI]==="string"){T.payload+=aB(aH[aI],aJ[aH[aI]])}else{if(ao.isArray(aH[aI])&&aH[aI].length===2){T.payload+=aB(aH[aI][0],aJ[aH[aI][1]])}else{if((typeof aH[aI]==="object")&&(aH[aI].sendNull!==undefined)){T.payload+=((aJ[aH[aI].name]===undefined)||(aJ[aH[aI].name].length===0))?"":aB(aH[aI].name,aJ[aH[aI].name])}else{X(aJ.operation,"paramArray["+aI+"]: "+aH[aI],"Invalid paramArray element passed to addToPayload()")}}}}}function z(i){var aI;var aH=RegExp('FieldName="'+i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");ao("td.ms-formbody, td.ms-formbodysurvey").each(function(){if(aH.test(ao(this).html())){aI=ao(this);return false}});return aI}function k(i,aI){var aH=aI.substring(8);i.opheader=i.opheader.replace(aI,aH);i.opfooter=i.opfooter.replace(aI,aH);return i}function aB(aI,aH){var i=typeof aH!=="undefined"?aH:"";return"<"+aI+">"+i+"</"+aI+">"}function q(){return(Math.round(Math.random())-0.5)}function M(i){return((i.indexOf("http")===0)||(i.indexOf(Q)===0))?"<a href='"+i+"'>"+i+"</a>":i}function R(i){return i.substring(i.lastIndexOf(Q)+1,i.length)}var Z={"&":"&amp;",'"':"&quot;","<":"&lt;",">":"&gt;"};var H={"&amp;":"&","&quot;":'"',"&lt;":"<","&gt;":">"};function j(i){return i.replace(/([\&"<>])/g,function(aI,aH){return Z[aH]})}function I(i){return i.replace(/(&quot;|&lt;|&gt;|&amp;)/g,function(aI,aH){return H[aH]})}function L(i){if(typeof i==="string"){return i.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;")}else{return i}}function A(i){return i.replace(/&/g,"%26")}function n(i){var aH=i.split(ah);this.id=aH[0];this.value=aH[1]}function u(i){return i<10?"0"+i:i}ao.expr[":"].regex=function(aM,aJ,aI){var aN=aI[3].split(","),aH=/^(data|css):/,i={method:aN[0].match(aH)?aN[0].split(":")[0]:"attr",property:aN.shift().replace(aH,"")},aL="ig",aK=new RegExp(aN.join("").replace(/^\s+|\s+$/g,""),aL);return aK.test(ao(aM)[i.method](i.property))}})(jQuery);